/*!
 * Scrollify - v1.0.1
 *
 * Author: Michael Pazienza
 * Copyright 2012 Mass Relevance
 *
 * Scrollify allows for a custom scrollbar to work along with mousewheel and touch events.
 * 
 * USE: you will need a mask, content container, and scrollbar with handle
 * 
 * <div class="mask">
 *   <div class="content"></div>
 *   <div class="scrollbar"><div class="handle">&nbsp;</div></div>
 * </div>
 * 
 * CSS: you can use this boilerplate as a starter
 * 
 * .mask {height:100%;position:relative;overflow:hidden;}
 * .content {position:absolute;}
 * .scrollbar {height:100%;width:1em;top:0;right:0;background:#ccc;position:absolute;z-index:2;}
 * .scrollbar .handle {width:1em;height:6em;top:0;left:0;background:#fff;border-radius:15px;position:absolute;cursor:pointer;z-index:3;}
 * 
 * Your will then initialize the Scrollify function on the mask element $('.mask').Scrollify();
 */
(function(b,a){b.fn.Scrollify=function(f){var c={touch_enable:true,wheel_enable:true,bar_enable:true,handle_resize:true,auto_generate:false,class_bar:"scrollbar",class_handle:"handle",class_content:"content",job_interval:250},e=b(a);f=b.extend(c,f);function d(g){if(g.originalEvent){return g.originalEvent.changedTouches||g.originalEvent.touches}return g.touches}return this.each(function(){var r=b(this),u=r.find("."+f.class_bar),j=u.find("."+f.class_handle),m=r.find("."+f.class_content),p=0,s=false,h=0,o,g,q,w,t,n,v,i,l,k;k=function(){var x;if(m.outerHeight()<r.height()){if(u.is(":visible")){u.hide()}}else{if(!u.is(":visible")){u.show()}}if(f.handle_resize){x=r.height()/m.outerHeight();j.animate({height:(u.height()*x)+"px"})}};o=function(){u=b("<div>").addClass(f.class_bar);j=b("<div>").addClass(f.class_handle).appendTo(u);r.wrapInner(b("<div>").addClass(f.class_content));m=r.find("."+f.class_content);r.append(u)};l=function(x){x.preventDefault();x.stopPropagation();e.unbind("mouseup",g);e.unbind("mousemove",w);r.unbind("touchend.touchScroll touchcancel.touchScroll",v);r.unbind("touchmove.touchScroll",i);if(f.bar_enable){j.bind("mousedown",q)}if(f.touch_enable){r.bind("touchstart.touchScroll",n)}};g=function(x){x.preventDefault();x.stopPropagation();e.unbind("mouseup",g);e.unbind("mousemove",w);j.bind("mousedown",q)};q=function(x){x.preventDefault();x.stopPropagation();p=x.pageY-j.offset().top;j.unbind("mousedown",q);e.bind("mouseup",g);e.bind("mousemove",w)};w=function(A){A.preventDefault();A.stopPropagation();var y=u.innerHeight()-j.height(),z=A.pageY-u.offset().top-p,x;if(z<0){z=0}else{if(z>y){z=y}}x=(m.outerHeight()-r.innerHeight())*(z/y);j.css("margin-top",z+"px");if(m.outerHeight()>r.innerHeight()){m.css("margin-top",-(x)+"px")}};t=function(B){B.preventDefault();B.stopPropagation();var A=B.originalEvent.wheelDelta||-B.originalEvent.detail*2,y=-Math.abs(m.outerHeight()-r.innerHeight()),x=A+parseInt(m.css("margin-top"),10),z;if(x<y){x=y}else{if(x>0){x=0}}z=(u.innerHeight()-j.height())*Math.abs(x/y);j.css("margin-top",z+"px");m.css("margin-top",x+"px")};n=function(y){y.preventDefault();y.stopPropagation();var x=d(y)[0];s=true;h=x.pageY;r.unbind("touchstart.touchScroll",n);r.bind("touchend.touchScroll touchcancel.touchScroll",v);r.bind("touchmove.touchScroll",i)};v=function(x){x.preventDefault();x.stopPropagation();s=false;r.unbind("touchend.touchScroll touchcancel.touchScroll",v);r.unbind("touchmove.touchScroll",i);r.bind("touchstart.touchScroll",n)};i=function(B){B.preventDefault();B.stopPropagation();if(s){var A=(d(B)[0].pageY-h)*0.8,y=-Math.abs(m.outerHeight()-r.innerHeight()),x=A+parseInt(m.css("margin-top"),10),z;if(x<y){x=y}else{if(x>0){x=0}}z=(u.innerHeight()-j.height())*Math.abs(x/y);j.css("margin-top",z+"px");m.css("margin-top",x+"px")}};if(f.bar_enable){if(!u.length&&!j.length&&f.auto_generate){o()}j.bind("mousedown",q)}if(f.wheel_enable){r.bind("mousewheel DOMMouseScroll",t)}if(f.touch_enable){r.bind("touchstart.touchScroll",n)}e.bind("mouseleave",l);k();setInterval(k,f.job_interval)})}}(jQuery,window));